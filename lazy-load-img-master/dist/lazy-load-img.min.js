!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.LazyLoadImg=e()}(this,function(){"use strict";var t=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.getBoundingClientRect(),i=t.offsetWidth,o=t.offsetHeight,a=window.innerWidth,r=window.innerHeight,s=!(n.right-e.left<=0&&n.left+i-e.left<=0||n.left+e.right>=a&&n.right+e.right>=i+a),c=!(n.bottom-e.top<=0&&n.top+o-e.top<=0||n.top+e.bottom>=r&&n.bottom+e.bottom>=o+r);return 0!==t.width&&0!==t.height&&s&&c},e=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},n=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),i=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},o=function(){function t(){e(this,t),this.images={},this.canvas=document.createElement("canvas"),this.canvas.getContext("2d").globalAlpha=0}return n(t,[{key:"toBase64",value:function(t,e,n){if(this.images[t])return this.images[t];this.canvas.width=e,this.canvas.height=n;var i=this.canvas.toDataURL("image/png");return this.images[t]=i,i}},{key:"destroy",value:function(){this.images=null,this.canvas=null}}]),t}();return function(){function a(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e(this,a),this.options={el:document.querySelector("body"),mode:"default",time:300,done:!0,diy:{backgroundSize:"cover",backgroundRepeat:"no-repeat",backgroundPosition:"center center"},position:{top:0,right:0,bottom:0,left:0},before:function(t){},success:function(t){},error:function(t){}},t.position=i({},this.options.position,t.position),t.diy=i({},this.options.diy,t.diy),i(this.options,t),this.start()}return n(a,[{key:"start",value:function(){this._getTransparent||(this._getTransparent=new o),this._timer=!0,this._start()}},{key:"_start",value:function(){var e=this,n=this.options;clearTimeout(this._timer),this._timer&&(this._timer=setTimeout(function(){var i=Array.prototype.slice.apply(n.el.querySelectorAll("[data-src]"));if(!i.length&&n.done)return clearTimeout(e._timer);i.forEach(function(i){!i.dataset.LazyLoadImgState&&t(i,n.position)&&e.loadImg(i)}),e._start()},n.time))}},{key:"loadImg",value:function(t){var e=this,n=this.options;t.dataset.LazyLoadImgState="start",n.before.call(this,t);var o=new window.Image;o.src=t.dataset.src,o.addEventListener("load",function(){return"diy"===n.mode?(t.src=e._getTransparent.toBase64(t.src,t.width,t.height),n.diy.backgroundImage="url("+o.src+")",i(t.style,n.diy)):t.src=o.src,delete t.dataset.src,delete t.dataset.LazyLoadImgState,n.success.call(e,t)},!1),o.addEventListener("error",function(){delete t.dataset.src,delete t.dataset.LazyLoadImgState,n.error.call(e,t)},!1)}},{key:"destroy",value:function(){delete this._timer,this._getTransparent.destroy(),this._getTransparent=null}}]),a}()});
//# sourceMappingURL=lazy-load-img.min.js.map
